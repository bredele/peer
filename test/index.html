<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Peer connection</title>
</head>
<body>
	<video id="master" autoplay muted></video>
  <video id="slave" autoplay muted></video>
	<script src="../build/build.js"></script>
	<script>
	  var peer = require('peer');
	  // master
	  var master = peer(null, '#master');
	  master.on('error', function(e) {
	  	console.log('master error ', e);
	  });

	  // slave
	  var slave = peer(null);
	  slave.on('error', function(e) {
	  	console.log('slave error ', e);
	  });

	  master.use(function(ctx) {
	  	var Candidate = (RTCIceCandidate || mozRTCIceCandidate);
	  	master.on('candidate', function(candidate) {
	  		if(candidate) {
	  			slave.connection.addIceCandidate(new Candidate(candidate));
	  		}
	  	});

	  	slave.on('candidate', function(candidate) {
	  		if(candidate) {
	  			master.connection.addIceCandidate(new Candidate(candidate));
	  		}
	  	});


	  	slave.on('answer', function(offer) {
	  		console.log('master set remote from slave answer');
	  		master.remote(offer);
	  	});

	  	master.once('offer', function(offer) {
	  		console.log('slave set remote with master offer');
	  		slave.remote(offer);
	  		slave.answer();
	  	});

	  });


	</script>
</body>
</html>